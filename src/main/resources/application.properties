# Disable CSRF token requirement for REST form posts (Renarde controllers still handle their own tokens)
quarkus.rest-csrf.require-form-url-encoded=false

quarkus.langchain4j.timeout=60s
quarkus.transaction-manager.default-transaction-timeout=600

# File upload limits (RECOMMENDED)
quarkus.http.limits.max-body-size=10M
quarkus.http.limits.max-form-attribute-size=2048

# Allow direct invocation of ollama API
quarkus.rest-client.ollama-api.url=${quarkus.langchain4j.ollama.base-url}

# Chat parameters - Optimize this model for your hardware!
# QUARKUS_LANGCHAIN4J_OLLAMA_CHAT_MODEL_MODEL_NAME
quarkus.langchain4j.ollama.chat-model.model-name=llama3.2
# Not exposed: quarkus.langchain4j.ollama.chat-model.num-ctx=8192

quarkus.langchain4j.ollama.chat-model.temperature=0.3
quarkus.langchain4j.ollama.chat-model.top-p=0.8
quarkus.langchain4j.ollama.chat-model.top-k=20
#quarkus.langchain4j.ollama.log-requests=true
#quarkus.langchain4j.ollama.log-responses=true

# Embedding model - use nomic-embed-text from Ollama
quarkus.langchain4j.ollama.embedding-model.model-name=nomic-embed-text

# Configure dimension for nomic-embed-text
#   nomic-embed-text: 768
#   all-minilm: 384
#   mxbai-embed-large: 1024
quarkus.langchain4j.neo4j.dimension=768

# Neo4j connection (for Compose Dev Services)
quarkus.neo4j.uri=bolt://localhost:7687
quarkus.neo4j.authentication.username=neo4j
quarkus.neo4j.authentication.password=devpassword

# Limit Neo4j-OGM classpath scanning to app packages (avoid scanning the entire classpath)
org.neo4j.ogm.base-packages=dev.ebullient.soloplay.play.model

%test.quarkus.langchain4j.ollama.devservices.enabled=false
%test.quarkus.neo4j.devservices.enabled=false

%prod.quarkus.neo4j.authentication.password=${NEO4J_PASSWORD}
%prod.quarkus.langchain4j.ollama.base-url=${OLLAMA_URL}

%dev.quarkus.compose.devservices.files=compose.yml

campaign.chunk.size=500
campaign.chunk.overlap=50
campaign.setting.maxResults=10

# Chat memory configuration
# Uses MESSAGE_WINDOW to keep last N messages per storyThreadId
# Neo4jChatMemoryStore (CDI bean) auto-discovered for persistence
quarkus.langchain4j.chat-memory.type=message-window
quarkus.langchain4j.chat-memory.memory-window.max-messages=80

# Debug logging
quarkus.log.category."io.quarkus.resteasy.reactive".level=DEBUG
quarkus.log.category."io.quarkiverse.renarde".level=DEBUG
quarkus.log.category."io.quarkus.csrf".level=DEBUG
quarkus.log.category."dev.ebullient.soloplay".level=DEBUG
