<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Threads - Solo Play</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/inspector.css">
</head>
<body>
    <header>
        <h1>Solo Play - Story Threads</h1>
        <p>Select a story to continue or create a new adventure</p>
    </header>

    <main>
        {#if flash:success}
        <div class="flash success">{flash:success}</div>
        {/if}
        {#if flash:error}
        <div class="flash error">{flash:error}</div>
        {/if}

        <section class="story-threads-container">
            {#if threads.isEmpty()}
                <div class="empty-state">
                    <h2>No Story Threads Yet</h2>
                    <p>Create your first adventure to begin your solo play journey!</p>
                    <a href="/story/create" class="btn btn-primary">Create New Story Thread</a>
                </div>
            {#else}
                <nav class="actions">
                    <a href="/story/create" class="btn btn-primary">Create New Story Thread</a>
                </nav>

                <div class="story-threads-grid grid">
                    {#for thread in threads}
                        <article class="story-card card">
                            <header class="story-header">
                                <h2>{thread.name}</h2>
                                <span class="badge status-badge">{thread.status}</span>
                            </header>

                            <dl class="story-details">
                                <dt>Setting:</dt>
                                <dd>{thread.settingName}</dd>

                                {#if thread.adventureName}
                                <dt>Adventure:</dt>
                                <dd>{thread.adventureName} <span class="badge">{thread.followingMode}</span></dd>
                                {/if}

                                <dt>Current Day:</dt>
                                <dd>{thread.currentDay}</dd>

                                {#if thread.currentSituation}
                                <dt>Current Situation:</dt>
                                <dd>{thread.currentSituation}</dd>
                                {/if}

                                <dt>Last Played:</dt>
                                <dd>
                                    {#if thread.lastPlayedAt}
                                        {thread.lastPlayedAt.toString()}
                                    {#else}
                                        Never
                                    {/if}
                                </dd>
                            </dl>

                            <footer class="story-actions">
                                <a href="/story/{thread.id}/play" class="btn btn-primary">Play</a>
                                <a href="/story/{thread.id}/configure" class="btn btn-secondary">Configure</a>
                                <a href="/inspect?storyThreadId={thread.id}" class="btn btn-secondary">Inspect</a>
                            </footer>
                        </article>
                    {/for}
                </div>
            {/if}
        </section>
    </main>
</body>
</html>
