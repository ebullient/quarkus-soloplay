<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play: {thread.name}</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/play.css">
</head>
<body>
    <div class="play-container">
        <!-- Party Sidebar -->
        <aside class="party-sidebar">
            <h3>Party</h3>
            {#if partyMembers.isEmpty()}
                <p class="empty-party">No party members yet. Create your character by chatting with the GM!</p>
            {#else}
                {#for character in partyMembers}
                    <div class="party-member">
                        <h4>{character.name}</h4>
                        <p>{character.summary}</p>
                        {#if character.tags}
                            <div class="tags">
                                {#for tag in character.tags}
                                    <span class="tag">{tag}</span>
                                {/for}
                            </div>
                        {/if}
                    </div>
                {/for}
            {/if}

            <nav class="action-links sidebar-links" aria-label="Story actions">
                <a href="/story">â† Switch Story</a>
                <a href="/story/{thread.slug}/configure">âš™ï¸ Configure</a>
                <a href="/inspect?storyThreadId={thread.id}">ğŸ” Inspect Data</a>
                <a href="/lore">ğŸ“– Query Lore</a>
            </nav>
        </aside>

        <!-- Main Play Area -->
        <main>
            <header class="story-header">
                <h1>{thread.name}</h1>
                <div class="story-meta">
                    <span>ğŸ“ {thread.settingName}</span>
                    <span>ğŸ“… Day {thread.currentDay}</span>
                    {#if thread.adventureName}
                        <span>ğŸ“œ {thread.adventureName}</span>
                    {/if}
                    {#if thread.followingMode}
                        <span>ğŸ¯ {thread.followingMode}</span>
                    {/if}
                </div>
            </header>

            {#if thread.currentSituation}
                <aside class="current-situation">
                    <h3>Current Situation</h3>
                    <p>{thread.currentSituation}</p>
                </aside>
            {/if}

            <section class="chat-area">
                <div id="chat-messages">
                    <div class="message system">
                        Welcome to your solo adventure! Describe what your character does, ask questions, or request a ruling from the GM.
                    </div>
                </div>

                <div class="input-area">
                    <input type="text"
                           id="message-input"
                           placeholder="What do you do?"
                           autocomplete="off"
                           autofocus>
                    <button id="send-button">Send</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Store story thread info
        const storyThread = {
            id: '{thread.id}',
            slug: '{thread.slug}',
            name: '{thread.name}'
        };
    </script>
    <script src="/play-interface.js"></script>
</body>
</html>
