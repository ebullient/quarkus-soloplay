{"id":"quarkus-soloplay-4mo","title":"Fix Game Dashboard header - remove old campaign selector","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-12T15:45:52.88452-05:00","created_by":"elh","updated_at":"2026-01-12T15:45:52.88452-05:00"}
{"id":"quarkus-soloplay-6b5","title":"View/edit story thread metadata and tags","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T15:45:52.813115-05:00","created_by":"elh","updated_at":"2026-01-12T15:45:52.813115-05:00"}
{"id":"quarkus-soloplay-ghc","title":"QSU review fixes: critical + UX improvements","description":"Post-implementation review of QSU epic (quarkus-soloplay-qsu) identified correctness and UX issues. See tmp/qsu-review.md for full analysis.\n\n## Critical Fixes\n1. WS failure handling - don't persist/emit on error\n2. Atomic transcript sequencing - prevent race conditions\n3. Neo4j indexes for ConversationMessage and ChatMemory\n\n## UX Improvements\n4. Redirect after story creation (POST /story/create -\u003e /story/{slug}/play)\n5. Remove server-side GM greeting injection (let WebSocket drive all messages)\n6. Add connection status indicator to UI","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-10T12:12:31.056952-05:00","created_by":"elh","updated_at":"2026-01-10T12:12:38.165366-05:00"}
{"id":"quarkus-soloplay-ghc.1","title":"Fix WebSocket failure handling","description":"StoryPlayWebSocket.java: onFailure().recoverWithItem() doesn't prevent doneMessage Multi from executing. Partial content gets persisted and assistant_done emits after error.\n\nFix: Use AtomicBoolean to track success, skip doneMessage on failure, don't persist to transcript or update lastPlayedAt on error.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T12:12:54.584181-05:00","created_by":"elh","updated_at":"2026-01-10T12:19:48.078572-05:00","closed_at":"2026-01-10T12:19:48.078572-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.1","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:12:54.58896-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.2","title":"Make transcript sequencing atomic","description":"StoryRepository.java: getNextConversationSeq() runs in separate session before addConversationMessage() transaction. Race condition possible with concurrent tabs.\n\nFix: Move sequence calculation inside the transaction.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T12:12:54.679685-05:00","created_by":"elh","updated_at":"2026-01-10T12:20:07.371755-05:00","closed_at":"2026-01-10T12:20:07.371755-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.2","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:12:54.680484-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.3","title":"Add Neo4j indexes for ConversationMessage and ChatMemory","description":"neo4j-indexes.cypher is missing constraints/indexes for new node types:\n- ConversationMessage.id (unique)\n- ConversationMessage.storyThreadId (index)\n- ConversationMessage (storyThreadId, seq) composite\n- ChatMemory.id (unique)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T12:12:54.769049-05:00","created_by":"elh","updated_at":"2026-01-10T12:20:23.985543-05:00","closed_at":"2026-01-10T12:20:23.985543-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.3","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:12:54.769803-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.4","title":"Redirect after story creation","description":"Story.java createPost() returns Templates.play() directly instead of redirecting. URL stays at /story/create, refresh prompts form resubmission.\n\nFix: Change to redirect(Story.class).play(thread.getId())","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T12:12:54.855788-05:00","created_by":"elh","updated_at":"2026-01-10T12:20:43.347649-05:00","closed_at":"2026-01-10T12:20:43.347649-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.4","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:12:54.856543-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.5","title":"Remove server-side GM greeting injection","description":"Story.java play() generates gmGreeting via blocking gameMaster.chat() but it's not persisted to transcript. Can repeat on reload, pollutes chat memory.\n\nFix: Remove gmGreeting from Templates.play() signature, remove greeting generation logic and buildInitialPrompt() method. Let WebSocket drive all messages.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T12:12:54.941992-05:00","created_by":"elh","updated_at":"2026-01-10T12:21:32.497208-05:00","closed_at":"2026-01-10T12:21:32.497208-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.5","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:12:54.942714-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.6","title":"Add connection status indicator to UI","description":"play-interface.js references #connection-status indicator but play.html doesn't render it.\n\nFix: Add \u003cspan id='connection-status'\u003e element to play.html header, add CSS styles to _play.scss.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T12:12:55.039573-05:00","created_by":"elh","updated_at":"2026-01-10T12:21:57.680833-05:00","closed_at":"2026-01-10T12:21:57.680833-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.6","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:12:55.040339-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.7","title":"Verify QSU fixes end-to-end","description":"Manual verification after all fixes implemented:\n\n1. Create new story → verify redirect to /story/{slug}/play (not stuck at /story/create)\n2. Open play page → verify no server-side greeting, just static welcome message\n3. Send message → verify streaming works normally\n4. Force error (disconnect mid-stream) → verify no partial content persisted to transcript\n5. Open two tabs, send messages simultaneously → verify no seq collision in ConversationMessage\n6. Check connection indicator updates on connect/disconnect/reconnect\n\nAssignee: human","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-10T12:13:55.348353-05:00","created_by":"elh","updated_at":"2026-01-12T11:27:25.249806-05:00","dependencies":[{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:13:55.349196-05:00","created_by":"elh"},{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc.1","type":"blocks","created_at":"2026-01-10T12:14:05.476458-05:00","created_by":"elh"},{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc.2","type":"blocks","created_at":"2026-01-10T12:14:05.52658-05:00","created_by":"elh"},{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc.3","type":"blocks","created_at":"2026-01-10T12:14:05.57524-05:00","created_by":"elh"},{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc.4","type":"blocks","created_at":"2026-01-10T12:14:05.624558-05:00","created_by":"elh"},{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc.5","type":"blocks","created_at":"2026-01-10T12:14:05.675416-05:00","created_by":"elh"},{"issue_id":"quarkus-soloplay-ghc.7","depends_on_id":"quarkus-soloplay-ghc.6","type":"blocks","created_at":"2026-01-10T12:14:05.724804-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-ghc.8","title":"Broadcast WebSocket messages to all connections per story thread","description":"Multiple tabs/browsers opening the same storyThread should share the session:\n- Shared generation lock per storyThreadId (not per connection)\n- Broadcast assistant_start/delta/done to all connections watching that story\n- Enables limited multiplayer if users want to bring a friend\n\nUses Quarkus WebSockets Next OpenConnections to broadcast.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-10T12:32:32.629788-05:00","created_by":"elh","updated_at":"2026-01-10T12:34:25.625997-05:00","closed_at":"2026-01-10T12:34:25.625997-05:00","close_reason":"Closed","dependencies":[{"issue_id":"quarkus-soloplay-ghc.8","depends_on_id":"quarkus-soloplay-ghc","type":"parent-child","created_at":"2026-01-10T12:32:32.630569-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-qsu","title":"WebSocket streaming play + server-side memory","description":"## Goal\nReplace stateless `/api/story/play` request/response with a WebSocket-based streaming “Play” experience with server-side persisted conversation memory and history.\n\n## Current State\n- Backend: `PlayAgent` + `GameMasterService` invoked via `POST /api/story/play` (`dev.ebullient.soloplay.api.StoryResource#play`)\n- Frontend: `src/main/resources/META-INF/resources/play-interface.js` uses `fetch()` and stores history in `localStorage`\n- Memory: ephemeral (no persisted `ChatMemoryStore`)\n\n## Target State\n- WebSocket endpoint: `/ws/story/{storyThreadId}` streams tokens/events\n- Server-side conversation continuity via persisted `ChatMemoryStore` (Neo4j)\n- Server-side transcript/history so UI does not depend on `localStorage`\n- Memory compaction/eviction hook creates durable story artifacts (e.g., `StoryEvent` summaries)\n\n## Key Decisions\n- Memory key: `storyThreadId` (same as current `@MemoryId String storyThreadId`)\n- Streaming: LangChain4j `TokenStream` for partial deltas + final completion\n- Rendering: stream text; final message replaces placeholder with server-rendered HTML (CommonMark via `MarkdownAugmenter`)\n\n## Milestones\n1) WS protocol + endpoint skeleton\n2) `PlayAgent.chatStream(...)` + streaming orchestration service\n3) Persisted `ChatMemoryStore` in Neo4j (+ config)\n4) Transcript persistence + history_request\n5) Compaction hook -\u003e `StoryEvent` creation\n6) Switch play UI to WebSocket + reconnect/history\n\n## Risks / Notes\n- Concurrency: enforce 1 in-flight generation per WS connection; decide multi-tab behavior for same story thread.\n- Consider adding `io.quarkiverse.langchain4j:quarkus-langchain4j-websockets-next` later if we want WS-connection-based default memory IDs; not required if we keep `@MemoryId storyThreadId`.\n\n","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-09T14:46:37.592207-05:00","created_by":"elh","updated_at":"2026-01-10T08:57:20.025362-05:00","closed_at":"2026-01-10T08:57:20.025365-05:00","close_reason":"Epic complete. Implemented: WebSocket endpoint (qsu.1), PlayAgent streaming (qsu.2), GameMasterService consolidation (qsu.3), transcript persistence (qsu.4), streaming UI (qsu.5), and memory compaction events (qsu.6/qsu.7)."}
{"id":"quarkus-soloplay-qsu.1","title":"WS protocol + StoryPlayWebSocket skeleton","design":"## Goal\nCreate `/ws/story/{storyThreadId}` WebSocket endpoint for Play with a stable JSON protocol for streaming.\n\n## Protocol\nClient -\u003e Server (JSON):\n- `{\"type\":\"history_request\",\"limit\":100}`\n- `{\"type\":\"user_message\",\"id\":\"\u003cuuid\u003e\",\"text\":\"...\"}`\n- (optional) `{\"type\":\"cancel\",\"id\":\"\u003cuuid\u003e\"}`\n\nServer -\u003e Client (JSON):\n- `{\"type\":\"session\",\"storyThreadId\":\"...\",\"storyName\":\"...\"}`\n- `{\"type\":\"history\",\"messages\":[{\"role\":\"user|assistant\",\"markdown\":\"...\",\"html\":\"...\",\"ts\":\"...\"}]}`\n- `{\"type\":\"assistant_start\",\"id\":\"\u003cuuid\u003e\"}`\n- `{\"type\":\"assistant_delta\",\"id\":\"\u003cuuid\u003e\",\"text\":\"...\"}`\n- `{\"type\":\"assistant_done\",\"id\":\"\u003cuuid\u003e\",\"markdown\":\"...\",\"html\":\"...\"}`\n- `{\"type\":\"error\",\"id\":\"\u003cuuid\u003e\",\"message\":\"...\"}`\n\n## Acceptance\n- Connection open sends `session` (or `error` if story thread missing)\n- Sending `user_message` yields `assistant_start` + one or more `assistant_delta` + `assistant_done`\n- Endpoint enforces 1 in-flight generation per connection (reject or queue)\n\n## Implementation Notes\n- New endpoint: `src/main/java/dev/ebullient/soloplay/api/StoryPlayWebSocket.java`\n- Message models: `src/main/java/dev/ebullient/soloplay/api/ws/PlayWsClientMessage.java`, `.../PlayWsServerMessage.java`\n","acceptance_criteria":"Client can connect to /ws/story/{id}; server sends session; user_message returns assistant_start/delta/done messages","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:46:55.752517-05:00","created_by":"elh","updated_at":"2026-01-09T18:04:04.728618-05:00","closed_at":"2026-01-09T18:04:04.728618-05:00","close_reason":"Implemented WebSocket endpoint skeleton with protocol, message models, and tests. Ready for streaming integration in qsu.2/qsu.3.","dependencies":[{"issue_id":"quarkus-soloplay-qsu.1","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:46:55.755475-05:00","created_by":"elh"}],"comments":[{"id":1,"issue_id":"quarkus-soloplay-qsu.1","author":"elh","text":"## Research Complete\n\nExplored codebase:\n- PlayAgent uses @Agent + @MemoryId + @ToolBox pattern\n- GameMasterService orchestrates context loading + AI call + timestamp update\n- StoryThread accessed via storyRepository.findStoryThreadById(slug)\n\nKey findings:\n- quarkus-langchain4j-websockets-next already in pom.xml\n- Quarkus WebSocket-next uses @WebSocket annotation with path params\n- Streaming in Quarkus LangChain4j uses Multi\u003cString\u003e return type\n- Need to verify @Agent compatibility with streaming (affects qsu.2)\n\nQuestions raised:\n1. Message model location: new ws/ subpackage vs inline?\n2. user_message ID: client-generated vs server-generated?\n3. Cancel message: stub or defer?\n4. @Agent + Multi\u003cString\u003e compatibility - need to verify","created_at":"2026-01-09T21:23:34Z"},{"id":2,"issue_id":"quarkus-soloplay-qsu.1","author":"Erin Schnabel","text":"1. New ws/ package to make it obvious it isn't Request/Response (different semantics)\n2. Server generated user message, I think. (session id.. w/ the websocket)\n3. Let's defer cancel message.\n4. WE'll have to try it.\n\nhttps://docs.quarkiverse.io/quarkus-langchain4j/dev/websockets.html\nhttps://docs.quarkiverse.io/quarkus-langchain4j/dev/guide-streamed-responses.html#_streaming_with_websockets","created_at":"2026-01-09T22:51:37Z"}]}
{"id":"quarkus-soloplay-qsu.2","title":"Add PlayAgent TokenStream method","description":"## Goal\nAdd streaming API to `PlayAgent` using LangChain4j `TokenStream`, while keeping current non-streaming method for REST fallback.\n\n## Acceptance\n- `PlayAgent` exposes `TokenStream chatStream(...)` mirroring the existing parameter set (including `@MemoryId storyThreadId` and `@UserMessage`)\n- Existing `String chat(...)` remains unchanged and continues to back `POST /api/story/play`\n- Streaming emits partial deltas and final completion\n\n## Notes\n- Uses LangChain4j `dev.langchain4j.service.TokenStream`\n- Provider must support streaming (Ollama typically does; validate behavior with configured model)\n","design":"File: PlayAgent.java","acceptance_criteria":"PlayAgent exposes chatStream(...) returning TokenStream; existing chat(...) remains for REST fallback","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:47:06.358302-05:00","created_by":"elh","updated_at":"2026-01-09T18:50:23.267156-05:00","closed_at":"2026-01-09T18:50:23.267156-05:00","close_reason":"Added chatStream() method to PlayAgent returning Multi\u003cString\u003e. Both methods share @SystemMessage at interface level. Existing blocking chat() preserved for REST fallback.","dependencies":[{"issue_id":"quarkus-soloplay-qsu.2","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:47:06.361185-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-qsu.3","title":"GameMasterStreamingService orchestration","description":"## Goal\nAdd a streaming orchestration service that loads story context and streams agent output to the WebSocket client.\n\n## Responsibilities\n- Load `StoryThread` (same logic as current `GameMasterService.chat`)\n- Call `PlayAgent.chatStream(...)`\n- Wire `TokenStream` callbacks:\n  - onPartialResponse -\u003e send `assistant_delta`\n  - onCompleteResponse -\u003e render markdown -\u003e HTML via `MarkdownAugmenter`, send `assistant_done`\n  - onError -\u003e send `error`\n- Update `StoryThread.lastPlayedAt` on successful completion\n\n## Acceptance\n- WS responses include HTML in `assistant_done` and deltas in `assistant_delta`\n- `lastPlayedAt` updates once per completed assistant response\n- Errors don’t kill the WS connection (unless unrecoverable)\n\n## Files\n- `src/main/java/dev/ebullient/soloplay/ai/GameMasterStreamingService.java` (new)","design":"Files: GameMasterStreamingService.java, reuse MarkdownAugmenter","acceptance_criteria":"Loads StoryThread; streams deltas to WS; updates lastPlayedAt on completion; handles errors","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:47:44.132219-05:00","created_by":"elh","updated_at":"2026-01-09T18:56:40.834586-05:00","closed_at":"2026-01-09T18:56:40.834586-05:00","close_reason":"Added streaming methods to GameMasterService (chatStream, completeChat, markdownToHtml). Wired into StoryPlayWebSocket with proper Multi concatenation. Deleted separate GameMasterStreamingService - consolidated into single service.","dependencies":[{"issue_id":"quarkus-soloplay-qsu.3","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:47:44.135333-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-qsu.4","title":"Transcript persistence + history_request","description":"## Goal\nPersist full conversation transcript in Neo4j for UI history, independent of the chat memory window, and support `history_request`.\n\n## Rationale\nLangChain4j chat memory is a bounded window for prompting, not a durable user-facing chat log. UI history should come from a separate store.\n\n## Data Model\nAppend-only message nodes, keyed by story thread:\n- `storyThreadId`, `role` (user/assistant), `markdown`, `html`, `ts`, `seq` (monotonic per thread)\n\n## API\n- WS `history_request {limit}` returns `history` message with last N transcript entries (ordered oldest-\u003enewest)\n- (optional later) REST `GET /api/story/{slug}/history?limit=N`\n- start with history_request default limit=200\n\n\n## Acceptance\n- Refreshing browser loads prior messages from server transcript (no localStorage required)\n- Transcript is written for both user messages and assistant final responses\n\n## Files\n- `src/main/java/dev/ebullient/soloplay/data/ConversationMessage.java` (new)\n- Repository methods (new class or extend `StoryRepository`)","design":"Files: ConversationMessage.java + repository changes","acceptance_criteria":"Server can send last N turns from Neo4j transcript; UI no longer depends on localStorage","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:47:59.450372-05:00","created_by":"elh","updated_at":"2026-01-10T07:34:26.910144-05:00","closed_at":"2026-01-10T07:34:26.910144-05:00","close_reason":"Implemented transcript persistence: ConversationMessage entity, repository CRUD methods, WebSocket integration for saving user/assistant messages, and history_request handler","dependencies":[{"issue_id":"quarkus-soloplay-qsu.4","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:47:59.453238-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-qsu.5","title":"WebSocket play-interface.js (streaming UI)","description":"## Goal\nReplace fetch/localStorage chat UI with a WebSocket streaming client.\n\n## Behavior\n- Open WS to `/ws/story/{storyThreadId}`\n- On open: send `history_request`\n- On send:\n  - append user message immediately\n  - create assistant placeholder bubble\n  - disable input until `assistant_done` (or implement queueing)\n- On `assistant_delta`: append streamed text to placeholder using `textContent`\n- On `assistant_done`: replace placeholder content with server-provided `html`\n- Reconnect with backoff; on reconnect re-request history\n\n## Acceptance\n- Tokens stream into UI without waiting for full completion\n- Reload shows history from server transcript\n- localStorage usage removed for play history\n\n## Files\n- `src/main/resources/META-INF/resources/play-interface.js`\n- `src/main/resources/templates/Story/play.html` (script wiring, optional connection indicator)","design":"Files: META-INF/resources/play-interface.js, templates/Story/play.html","acceptance_criteria":"UI streams assistant tokens; final message renders HTML from server; reconnect re-requests history","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:48:08.150006-05:00","created_by":"elh","updated_at":"2026-01-10T08:03:53.165359-05:00","closed_at":"2026-01-10T08:03:53.165359-05:00","close_reason":"Implemented WebSocket streaming UI: play-interface.js rewritten with WS connection, reconnect logic, history_request on connect, streaming delta handling, and final HTML replacement. Added SCSS for streaming cursor and connection status indicator.","dependencies":[{"issue_id":"quarkus-soloplay-qsu.5","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:48:08.153223-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-qsu.6","title":"Memory compaction hook -\u003e StoryEvent creation","description":"## Goal\nWhen chat memory window overflows and older messages are dropped, create durable story artifacts so important events aren’t lost.\n\n## Approach\n- Detect compaction in `ChatMemoryStore.updateMessages(memoryId, newMessages)` by comparing stored previous list with new list\n- If messages were dropped, publish a CDI event `ChatMemoryCompacted(storyThreadId, droppedMessages)`\n- Listener creates a `StoryEvent`:\n  - MVP: store raw dropped text (or a truncated excerpt) as an event with tags like `memory,summary`\n  - Better: run a summarizer LLM call over dropped messages and store a compact “story so far” summary\n\n## Acceptance\n- When memory window drops messages, at least one `StoryEvent` is created for that story thread\n- Events tagged to allow later retrieval (e.g., `memory`, `summary`)\n\n## Files\n- `src/main/java/dev/ebullient/soloplay/ai/memory/ChatMemoryCompactedEvent.java`\n- `src/main/java/dev/ebullient/soloplay/ai/memory/ChatMemoryCompactionListener.java`","design":"Files: ChatMemoryCompactedEvent.java, ChatMemoryCompactionListener.java","acceptance_criteria":"When memory window drops messages, a StoryEvent is created (tags: memory/summary)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:48:14.453611-05:00","created_by":"elh","updated_at":"2026-01-10T07:53:45.879896-05:00","closed_at":"2026-01-10T07:53:45.879896-05:00","close_reason":"Implemented memory compaction: ChatMemoryCompactedEvent CDI event, Neo4jChatMemoryStore detects dropped messages and fires event, ChatMemoryCompactionListener creates StoryEvents with tags memory/summary/auto-generated","dependencies":[{"issue_id":"quarkus-soloplay-qsu.6","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:48:14.456637-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-qsu.7","title":"Neo4jChatMemoryStore (persist LangChain4j memory)","description":"## Goal\nPersist LangChain4j chat memory to Neo4j so conversation continuity survives restarts.\n\n## Implementation\nImplement `dev.langchain4j.store.memory.chat.ChatMemoryStore`:\n- Key: `storyThreadId` (Object from `@MemoryId`)\n- Stored value: serialized `List\u003cChatMessage\u003e` using LangChain4j serializer/deserializer\n- Node shape (simple):\n  - `(:ChatMemory {id: \u003cstoryThreadId\u003e, messagesJson: \"...\", updatedAt: ...})`\n\n## Configuration\n- Use Quarkus LangChain4j default memory provider with MESSAGE_WINDOW:\n  - `quarkus.langchain4j.chat-memory.type=MESSAGE_WINDOW`\n  - `quarkus.langchain4j.chat-memory.memory-window.max-messages=80`\n\n## Acceptance\n- For the same `storyThreadId`, memory persists across app restart\n- Memory window respects configured max-messages\n- (If implementing compaction detection here) emits compaction event when messages are dropped\n\n## Files\n- `src/main/java/dev/ebullient/soloplay/ai/memory/Neo4jChatMemoryStore.java`\n- `src/main/resources/application.properties`\n- `src/main/resources/neo4j-indexes.cypher` (optional index/constraint for ChatMemory.id)","design":"Files: Neo4jChatMemoryStore.java; config in application.properties","acceptance_criteria":"ChatMemoryStore reads/writes messages keyed by storyThreadId; survives restart","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:57:39.607478-05:00","created_by":"elh","updated_at":"2026-01-09T18:19:04.728969-05:00","closed_at":"2026-01-09T18:19:04.728969-05:00","close_reason":"Implemented Neo4jChatMemoryStore with full CRUD operations. Quarkus auto-discovers as CDI bean. Configured MESSAGE_WINDOW with 80 messages max.","dependencies":[{"issue_id":"quarkus-soloplay-qsu.7","depends_on_id":"quarkus-soloplay-qsu","type":"parent-child","created_at":"2026-01-09T14:57:39.608181-05:00","created_by":"elh"}]}
{"id":"quarkus-soloplay-sbe","title":"Delete story threads with confirmation dialog","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-12T15:45:52.738878-05:00","created_by":"elh","updated_at":"2026-01-12T15:45:52.738878-05:00"}
